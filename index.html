<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>COVID-19 and the future</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
    <link href="https://fonts.googleapis.com/css?family=Comfortaa:700" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="comparison.css">

    <script>
        $(document).ready(function(){
            $('.combine').on('change', function(){
                var combinedStates = $('#filter').val() + $('#state1').val() + $('#state2').val();
                var radioValue = $("input[name='gender']:checked").val() + '.json';
                $('#combinedStates').val(combinedStates+radioValue);
                console.log(combinedStates+radioValue);
            });
        })
    </script>
</head>
<body>
    <div id="loading">
        <div id="spinner"></div>
    </div>
    <div id="particles-js"></div>
    <div id="box">
        <div class="box1 onlywide animated bounceOutLeft" style="animation-delay:1.7s;"></div>
        <div class="box2 onlywide animated bounceOutLeft" style="animation-delay:1.8s;"></div>
        <div class="box2 onlywide animated bounceOutLeft" style="animation-delay:1.9s;"></div>
        <div class="box2 animated bounceOutRight" style="animation-delay:1.9s;"></div>
        <div class="box2 onlywide animated bounceOutRight" style="animation-delay:1.8s;"></div>
        <div class="box2 onlywide animated bounceOutRight" style="animation-delay:1.7s;"></div>
    </div>
    <a id="timeline" onclick="showtimeline()" class="animated fadeIn" style="animation-delay:2.2s;">timeline</a>
    <a id="comparison" onclick="showcomparison()" class="animated fadeIn" style="animation-delay:2.2s;">comparison between 2 states</a>
    <a id="Interestingfacts" onclick="showInterestingfacts()" class="animated fadeIn" style="animation-delay:2.2s;">Interesting facts</a>
    <div id="middle" class="animated slideInDown" style="animation-delay:2.0s;">
        <h1>COVID-19 and the future</h1>
        <h2>add something here!!</h2>
        <div id="menu">
            <a onclick="showtimeline()">timeline</a>
            <a onclick="showcomparison()">comparison</a>
            <a onclick="showInterestingfacts()">Interesting facts</a>
        </div>
        <table>
                <tr>
                    <td class="animated zoomIn" style="animation-delay:2.2s;"><a class="social"><i class="fab fa-facebook"></i></a></td>
                    <td class="animated zoomIn" style="animation-delay:2.4s;"><a class="social"><i class="fab fa-twitter"></i></a></td>
                    <td class="animated zoomIn" style="animation-delay:2.6s;"><a class="social"><i class="fab fa-instagram"></i></a></td>
                    <td class="animated zoomIn" style="animation-delay:2.8s;"><a class="social"><i class="fab fa-dribbble"></i></a></td>
                </tr>
        </table>
    </div>
    <div id="comparison_container" class="container" style="height: 100vh;">
        <div>
        <div class="div-inline" onclick="closecomparison()"><i class="fas fa-angle-right"></i></div>
        <h3 class="div-inline" onclick="closecomparison()">Comparison between 2 states</h3>
            <div id="filter-position">
                <div>
                    <p>Use the options below to compare two states along with other filters.</p>
                </div>
                <hr>
                <div>
                    <label>Filter: </label>
                    <SELECT class="combine" id ="filter">
                        <option>Productivity</option>
                        <option>Employment</option>
                    </SELECT><br>
                    <p> 
                        <label>Gender: </label>
                        <label><input type="radio" name="gender" value="Male">Male</label> 
                        <label><input type="radio" name="gender" value="Female">Female</label>
                        <label><input type="radio" name="gender" value="All">All</label>
                    </p><br>
                    <label>State 1: </label>
                    <SELECT class="combine" id ="state1">
                        <option>Arizona</option>
                        <option>California</option>
                    </SELECT><br>
                    <label>State 2: </label>
                    <SELECT class="combine" id ="state2">
                        <option>Arizona</option>
                        <option>California</option>
                    </SELECT><br><br>
                    <input type="hidden" id="combinedStates"/>
                    <button class="btn_one" onclick="drawGraph(combinedStates.value)">Compare</button>
                </div>
            </div>

            <div id="chart" class="graph-position">
            </div>

        <script src='https://d3js.org/d3.v4.min.js'></script>
        <script>
            d3version4 = d3
        </script>

        <script>
            const width = 800,
                height = 700,
                maxRadius = 450;
            
            const formatNumber = d3version4.format(',d');

            const x = d3version4.scaleLinear()
                .range([0, 2 * Math.PI])
                .clamp(true);

            const y = d3version4.scaleSqrt()
                .range([maxRadius*.1, maxRadius]);

            const color = d3version4.scaleOrdinal(d3version4.schemeCategory20);

            const partition = d3version4.partition();

            const arc = d3version4.arc()
                .startAngle(d => x(d.x0))
                .endAngle(d => x(d.x1))
                .innerRadius(d => Math.max(0, y(d.y0)))
                .outerRadius(d => Math.max(0, y(d.y1)));

            const middleArcLine = d => {
                const halfPi = Math.PI/2;
                const angles = [x(d.x0) - halfPi, x(d.x1) - halfPi];
                const r = Math.max(0, (y(d.y0) + y(d.y1)) / 2);

                const middleAngle = (angles[1] + angles[0]) / 2;
                const invertDirection = middleAngle > 0 && middleAngle < Math.PI;
                if (invertDirection) { angles.reverse(); }

                const path = d3version4.path();
                path.arc(0, 0, r, angles[0], angles[1], invertDirection);
                return path.toString();
            };

            const textFits = d => {
                const CHAR_SPACE = 6;

                const deltaAngle = x(d.x1) - x(d.x0);
                const r = Math.max(0, (y(d.y0) + y(d.y1)) / 2);
                const perimeter = r * deltaAngle;

                return d.data.name.length * CHAR_SPACE < perimeter;
            };

            function drawGraph(file) {
                d3version4.json(file, (error, root) => {
                    d3version4.select('#chart').select('svg').remove();

                    if (error) throw error;

                    root = d3version4.hierarchy(root);
                    root.sum(d => d.size);

                    const svg = d3version4.select('#chart').append('svg')
                        .style('width', '600')
                        .style('height', '600')
                        .attr('viewBox', `${-450} ${-200} ${900} ${400}`)
                        .on('click', () => focusOn());

                    const slice = svg.selectAll('g.slice')
                        .data(partition(root).descendants());

                    slice.exit().remove();

                    const newSlice = slice.enter()
                        .append('g').attr('class', 'slice')
                        .on('click', d => {
                            d3version4.event.stopPropagation();
                            focusOn(d);
                        });

                    newSlice.append('title')
                        .text(d => d.data.name + '\n' + formatNumber(d.value));
            
                    newSlice.append('path')
                        .attr('class', 'main-arc')
                        .style('fill', d => color((d.children ? d : d.parent).data.name))
                        .attr('d', arc);

                    newSlice.append('path')
                        .attr('class', 'hidden-arc')
                        .attr('id', (_, i) => `hiddenArc${i}`)
                        .attr('d', middleArcLine);
            
                    const text = newSlice.append('text')
                        .attr('display', d => textFits(d) ? null : 'none');

                    text.append('textPath')
                        .attr('startOffset','50%')
                        .attr('xlink:href', (_, i) => `#hiddenArc${i}` )
                        .text(d => d.data.name)
                        .style('fill', 'none')
                        .style('stroke', '#fff')
                        .style('stroke-width', 5)
                        .style('stroke-linejoin', 'round')
                        .style('font-size', '15px');

                    text.append('textPath')
                        .attr('startOffset','50%')
                        .attr('xlink:href', (_, i) => `#hiddenArc${i}` )
                        .text(d => d.data.name)
                        .style('font-size', '15px');

                    function focusOn(d = { x0: 0, x1: 1, y0: 0, y1: 1 }) {    
                        const transition = svg.transition()
                                            .duration(750)
                                            .tween('scale', () => {
                                                const xd = d3version4.interpolate(x.domain(), [d.x0, d.x1]),
                                                yd = d3version4.interpolate(y.domain(), [d.y0, 1]);
                                                return t => { x.domain(xd(t)); y.domain(yd(t)); };
                                            });

                        transition.selectAll('path.main-arc')
                            .attrTween('d', d => () => arc(d));
                
                        transition.selectAll('path.hidden-arc')
                            .attrTween('d', d => () => middleArcLine(d));
                
                        transition.selectAll('text')
                            .attrTween('display', d => () => textFits(d) ? null : 'none');
                
                        moveStackToFront(d);
            
                        function moveStackToFront(elD) {
                            svg.selectAll('.slice').filter(d => d === elD)
                                .each(function(d) {
                                    this.parentNode.appendChild(this);
                                    if (d.parent) { moveStackToFront(d.parent); }
                                })
                        };
                    }
                });
            }

            drawGraph('ProductivityAlabamaAlaskaAll.json');
        </script>
    </div>
    </div>
    <div id="timeline_container" class="container">
            <div onclick="closetimeline()"><i class="fas fa-angle-left"></i></div>
            <h1>Timeline</h1>
            <section>
                <h2>Timeline</h2>
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                </p>
                <p>
                    Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                </p>
            </section>
            <section>
                <h2>skills</h2>
                <p>
                    i do eveything ;)
                </p>
            </section>
        </div>
          <div id="Interestingfacts_container" class="container">
            <div onclick="closeInterestingfacts()"><i class="fas fa-angle-down"></i></div>
            <h1>Interesting facts.</h1>
            <section>
                <h2>Interesting facts</h2>
                <p>
                    <form>
                        <input type="text" placeholder="name" required>
                        <input type="email" placeholder="email" required><br>
                        <textarea placeholder="your message" required rows="5"></textarea><br>
                        <button class="btn_one">send</button>
                    </form> 
                </p>
            </section>
        </div>
        <div id="footer">
            made on earth by a human <br> <a href="https://imfunniee.github.io">imfunniee</a>
        </div>
    <script src="index.js" type="text/javascript"></script>
    <script src="particles.js"></script>
    <script src="app.js"></script>
</body>
</html>